---
title: "Orthanc"
description: "dicom server open source"
author: "BenKorea"
date: "2025-02-26"
date-modified: last-modified
categories: [dicom server, Orthanc]
---

## Window 운영체제에서의 설치

### orthanc.json 설정

"Name" : "Orthanc_win",

"HttpPort" : 8042,

"DicomAet" : "ORTHANC",

"DicomPort" : 4242,

"RemoteAccessAllowed" : false,

"DicomModalities" : {

```         
   "NMPACS" : [ "NMPACS", "172.17.111.214", 104 ],
   "RA600_3" : [ "RA600_3", "172.17.111.218", 104 ],
   "CONQUESTRA6003" : [ "CONQUESTRA600", "172.17.111.218", 5678 ],
   "NMDOSE_WIN" : [ "NMDOSE_WIN", "172.17.130.79", 5678 ],
   "NMIQ" : [ "NMIQ", "172.17.130.79", 5679 ],
   "NMFULLDATA" : [ "NMFULLDATA", "172.17.130.79", 5680 ],
   "NMTEMPSERVER" : [ "NMTEMPSERVER", "172.17.130.79", 5681 ],
   "ZETTAPACS" : [ "ZETTAPACS", "172.17.130.79", 5682 ],
   "O-wsl4343" : [ "ORTHANC_WSL", "127.0.0.1", 4343 ],
   "SLICER" : [ "SLICER", "172.17.130.79", 11112 ]
```

### 방화벽설정

인바운드 4343 허용

## WSL2/Ubuntu 환경에서의 설치

### 패키지 목록 업데이트

```{r sudo-apt-update, eval=FALSE, filename="bash"}
sudo apt update
```

### Orthanc 설치

```{r sudo-apt-install, eval=FALSE, filename="bash"}
sudo apt install orthanc
```

### orthanc.json 설정

```{r remote-access-allowed, eval=FALSE, filename="orthanc.json"}
sudo nano /etc/orthanc/orthanc.json
```

"Name" : "Orthanc_wsl2",

"HttpPort" : 8043,

"DicomAet" : "ORTHANC_WSL2"

"DicomPort" : 4243,

"RemoteAccessAllowed" : false,

"DicomModalities" : {

```         
    "Orthanc-win" : [ "ORTHANC", "172.21.112.1", 4242 ],
    "NMTEMPSERVER" : [ "NMTEMPSERVER", "172.21.112.1", 5681 ],
    "NMPACS" : [ "NMPACS", "172.17.111.214", 104 ]
```

### Orthanc 재시작

```{r restart-orthanc, eval=FALSE, filename="bash"}
sudo systemctl restart orthanc
```

### Orthanc Explorer2 plugin 설치

-   설치명령이 잘 작동하지 않아서 웹페이지에서 so 파일을 직접 다운로드 하였다.

```{r orthanc-explorer2-download, eval=FALSE, filename="browse"}
https://github.com/orthanc-server/orthanc-explorer-2/releases
```

-   libOrthancExplorer2-ubuntu.so 파일을 다운로드하여 /usr/share/orthanc/plugins 폴더에 저장하였다.
-   orthanc.json에서 아래와 같이 설정하였다.

```{r orthanc-explorer22, eval=FALSE, filename="orthanc.json"}
"Plugins" : {
  "OrthancExplorer2" : {
    "Enabled" : true,
    "Path" : "/usr/share/orthanc/plugins/libOrthancExplorer2-ubuntu.so"
  }
}
```

-   Orthanc을 재시작하였다.

```{r restart-orthanc2, eval=FALSE, filename="bash"}
sudo systemctl restart orthanc
```

```{r orthanc-explorer2, eval=FALSE, filename="bash"}
sudo apt install orthanc-explorer2
```

### Orthanc systemd 서비스 비활성화

```{r disable-orthanc, eval=FALSE, filename="bash"}
sudo systemctl disable orthanc
```

### Orthanc 수동 시작

```{r start-orthanc, eval=FALSE, filename="bash"}
sudo systemctl start orthanc
```

### 윈도우 포트포워딩 점검

```{r portproxy_show, eval=FALSE, filename="powershell"}
netsh interface portproxy show v4tov4
```

### 윈도우 포트포워딩 리셋

```{r portproxy_reset, eval=FALSE, filename="powershell"}
netsh interface portproxy reset
```

### WSL2_IP 알아내기

```{r wsl2_ip, eval=FALSE, filename="bash"}
sudo ip addr show eth0 | grep inet
```

172.21.120.237

### 포워딩

```{r portproxy_sho, eval=FALSE, filename="powershell"}
netsh interface portproxy add v4tov4 `
  listenaddress=0.0.0.0 listenport=4242 `
  connectaddress=172.21.120.237 connectport=4243 `
  protocol=tcp
```

### 방화벽

### 점검

```{r portproxy_check, eval=FALSE, filename="powershell"}
nc -vz <NMPACS_IP> 104
```

## orthanc-docker

-   orthanc-docker 폴더이름으로 orthanc 이미지로만 docker-compose를 실행하였다.
-   docker-compose.yml 파일에 docker network를 지정하지 않았기 때문에 orthanc-docker container와 함께 orthanc-docker_default 이름의 network가 만들어졌다.
-   DCM4CHEE은 compose로 했을 때의 값을 일단 그대로 해 보았다.

```         
            "dcm4chee" : [ "DCM4CHEE", "arc", 11112 ]
```

-   그러나 같은 네트워크에 속해있지 않기 때문에 orthanc-docker에서 DCM4CHEE에 접근할 수 없을 것이다.
